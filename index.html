<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUESTIONÁRIO</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <h1>QUESTIONÁRIO</h1>
        <!-- Suas perguntas continuam aqui -->
        <div id="question1" class="question">
            <p>1. Quando faz um trabalho em grupo, você é aquele(a) que:</p><br>
            <input type="radio" name="q1" value="1"> Fica preocupado(a) com o bem-estar do grupo.<br>
            <input type="radio" name="q1" value="2"> Organiza tudo o que tem que ser feito.<br>
            <input type="radio" name="q1" value="3"> Sugere coisas novas e diferentes.<br>
            <input type="radio" name="q1" value="4"> Gosta das atividades mais práticas.<br>
            <button onclick="showNextQuestion()">Próxima Pergunta</button>
        </div>
        <!-- Continue com o restante das perguntas como no seu código original -->
        
        <!-- Resultados -->
        <div id="result" class="question" style="display: none;">
            <p id="vocational-result"></p>
            <canvas id="resultChart"></canvas>
        </div>

        <!-- Formulário para envio do resultado por e-mail -->
        <form id="resultForm" action="https://api.staticforms.xyz/submit" method="post" style="display:none;">
            <input type="hidden" name="accessKey" value="8f7e4760-b8f7-4279-9fc9-7b05cbd3c830"> <!-- Insira a sua chave de acesso -->
            <input type="hidden" name="email" value="davi.liallem@fied.edu.br"> <!-- E-mail de destino -->
            <input type="hidden" name="subject" value="Resultado do Questionário Vocacional">
            <input type="hidden" id="messageResult" name="message">
            <input type="hidden" name="redirectTo" value="YOUR_REDIRECT_URL_HERE"> <!-- URL para onde o usuário será redirecionado após o envio -->
        </form>
    </div>

    <script src="script2.js"></script>
    <script>
        let currentQuestion = 1;
        let answersCount = [0, 0, 0, 0];

        document.getElementById('question1').style.display = 'block';

        function showNextQuestion() {
            const selectedOption = document.querySelector(`#question${currentQuestion} input[name=q${currentQuestion}]:checked`);

            if (!selectedOption) {
                currentQuestion++;
            } else {
                const answerValue = parseInt(selectedOption.value);
                answersCount[answerValue - 1]++;
                currentQuestion++;
            }

            const currentQuestionDiv = document.getElementById(`question${currentQuestion}`);
            if (currentQuestionDiv) {
                document.querySelector(`#question${currentQuestion - 1} button`).style.display = 'none';
                currentQuestionDiv.style.display = 'block';

                window.scrollBy(0, currentQuestionDiv.getBoundingClientRect().top - 100);
            } else {
                calculateResult();
            }
        }

        const nextButtons = document.querySelectorAll('.question button');
        nextButtons.forEach(button => {
            button.addEventListener('click', showNextQuestion);
        });

        function calculateResult() {
            const totalAnswers = answersCount.reduce((total, count) => total + count, 0);
            const percentages = answersCount.map(count => ((count / totalAnswers) * 100).toFixed(2));

            const areas = [
                { index: 1, percentage: percentages[0], text: 'Você pode seguir carreira nos cursos de Enfermagem, Fisioterapia e Odontologia' },
                { index: 2, percentage: percentages[1], text: 'Você pode seguir carreira nos cursos de Administração, Direito, Psicologia e Pedagogia' },
                { index: 3, percentage: percentages[2], text: 'Você pode seguir carreira nos cursos de Arquitetura e Urbanismo, Engenharia Ambiental e Sistemas de Informação' },
                { index: 4, percentage: percentages[3], text: 'Você pode seguir carreira nos cursos de Educação Física e Nutrição' }
            ];

            areas.sort((a, b) => b.percentage - a.percentage);

            let result = '';

            for (const area of areas) {
                result += `${area.text}: ${area.percentage}%\n`;
            }

            document.getElementById('vocational-result').innerText = result;

            const chartData = {
                labels: ['Saúde', 'Humanas', 'Exatas', 'Saúde preventiva'],
                datasets: [{
                    label: 'Porcentagem',
                    data: percentages,
                    backgroundColor: ['rgba(54, 162, 235, 0.5)', 'rgba(255, 99, 132, 0.5)', 'rgba(75, 192, 192, 0.5)', 'rgba(255, 206, 86, 0.5)'],
                    borderColor: ['rgba(54, 162, 235, 1)', 'rgba(255, 99, 132, 1)', 'rgba(75, 192, 192, 1)', 'rgba(255, 206, 86, 1)'],
                    borderWidth: 2,
                    borderRadius: 15,
                    hoverBorderColor: 'rgba(0, 0, 0, 0.2)',
                    barPercentage: 0.7
                }]
            };

            const chartConfig = {
                type: 'bar',
                data: chartData,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                borderDash: [5, 5],
                            },
                            ticks: {
                                color: '#A6192E',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false,
                            },
                            ticks: {
                                color: '#A6192E',
                                font: {
                                    size: 14
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: '#A6192E',
                                font: {
                                    size: 16
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleFont: {
                                size: 16
                            },
                            bodyFont: {
                                size: 14
                            },
                            callbacks: {
                                label: function(tooltipItem) {
                                    return `Porcentagem: ${tooltipItem.raw}%`;
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeOutBounce'
                    }
                }
            };

            document.getElementById('result').style.display = 'block';

            const ctx = document.getElementById('resultChart').getContext('2d');
            new Chart(ctx, chartConfig);

            // Envio do resultado por e-mail
            sendResultByEmail(result);
        }

        function sendResultByEmail(resultText) {
            // Adiciona o resultado ao campo de mensagem do formulário
            document.getElementById('messageResult').value = resultText;

            // Submete o formulário automaticamente
            document.getElementById('resultForm').submit();
        }
    </script>
</body>
</html>
